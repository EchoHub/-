### XSS攻击：脚本注入攻击，攻击者通过注入恶意脚本的方式，使之在用户界面上运行，从而获取到用户的Cookie、SessionID等，进而危害数据安全。
- 产生原因：攻击者通过恶意植入的方式注入网站，站点未进行代码过滤，从而导致恶意代码与正常的代码混淆，浏览器无法识别哪些代码是恶意的，从而正常执行恶意注入的代码。

- 不可信输入路径：
    - 用户的UGC内容
    - URL参数
    - 第三方链接
    - POST参数
    - Referer（不可信涞源的Referer）
    - Cookie（来自其他子域的cookie）

- ”危害“有哪些：
    - 劫持用户的cookie信息发送到攻击者的服务器
    - 钓鱼网站
    - 其他 ...

- XSS的分类：
    - 存储型(后端数据库)
        - 攻击者将恶意代码提交到目标网站的服务器
        - 用户打开目标网站请求服务器时，恶意代码拼接在HTML返回客户端
        - 客户端解析并正常执行恶意代码
        - 恶意代码执行窃取用户的信息传送至攻击者网站或通过用户信息攻击目标服务器

        - 这种攻击常见于用户保存数据的网站功能，如表单提交类（论坛发帖、商品评论等）
    
    - 反射型(URL)
        - 攻击者构造特殊的URL，其中包含恶意代码
        - 用户打开URL，网站服务器将恶意代码从URL中取出，拼接到HTML里面返回
        - 客户端解析HTML并正常执行
        - 恶意代码执行窃取用户的信息传送至攻击者网站或通过用户信息攻击目标服务器

        - 这种攻击常见于通过URL传递参数功能，如网站搜索、跳转等
    
    - DOM型（后端数据库/前端/URL）
        - 攻击者构造特殊的URL
        - 用户打开URL
        - 浏览器接收并解析、执行
        - 恶意代码窃取用户信息并上报攻击者服务器，或冒充用户调用接口攻击服务器

        - 这种攻击区别前两者在于，该类型由前端自身安全漏洞引起

- XSS实现的因素
    - 攻击者提交恶意代码
    - 浏览器执行恶意代码

- XSS攻击预防：
    - 输入过滤，对用户输入内容进行转义、规则过滤等
        - 对特殊字符进行转译
            - 原因：攻击者可以通过特殊字符突破原本属性的限制，从而形成有效代码进行攻击
        - 对内容进行校验，避免javascript以及其他非法schema开头的链接格式内容
            - 原因：攻击者可以通过类似javascript:形式构建非法链接或者构造执行代码
        - 对内联json进行转义
    
    - 预防存储型、反射型攻击：
        - 纯前端渲染（存储型、反射型）
        - HTML充分转义（存储型、反射型）
        - 避免使用innerHTML等方式

    - 预防DOM型攻击：
        - 避免直接使用innerHTML等方式插入HTML到页面上

    - 其他方式
        - 对Cookie限制httpOnly
        - 采取CSP策略（内容安全策略）
            - 禁止加载外域代码
            - 禁止外域提交
            - 禁止内联脚本执行
            - 禁止未授权的脚本执行
            - 合理使用上报及时发现XSS

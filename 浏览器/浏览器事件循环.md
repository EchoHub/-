# 浏览器事件循环

### 浏览器组成
- 主进程
    - 负责浏览器操作
    - 负责其他进程的管理
    - 网络资源的下载、管理等

- GPU进程
    - 用户3D绘制

- 第三方插件进程
    - 三方插件管理，每个插件开启一个进程

- 渲染进程
    - 页面渲染、脚本执行、事件处理等，每个页面对应一个进程

### 渲染进程组成
- GUI渲染线程
    - 负责浏览器的渲染：html解析、css解析、构建DOM、渲染树、布局、绘制等

- JS引擎线程
    - 负责解析、执行JavaScript代码
    - 处理任务队列里面的任务

- 事件触发线程
    - 用于控制事件循环

- 定时器线程
    - 用于处理定时器任务，并将任务回调添加等事件队列

- http请求线程
    - 用于创建http请求，并将请求回调放入任务队列

### 浏览器EventLoop
- 流程：
    - 浏览器把一次执行栈的执行称为一次宏任务执行
    - 在遇到微任务时会将其放入添加到微任务队列
    - 在遇到宏任务时会将其放入添加到宏任务队列
    - 当当前宏任务执行完成之后，会立即执行微任务队列里面的任务
    - 等执行完成之后会检测渲染，并将控制权交给GUI渲染线程进行渲染任务
    - 渲染完成之后，控制权会重新交给JS引擎线程，等待下一个宏任务的开始

- 宏任务：每次执行执行栈就是一次宏任务
- 微任务：在当前宏任务执行完成之后立即执行的任务，且在渲染之前完成
# 浏览器渲染流程
- 解析html，构成DOM树
    - 解析html过程中遇到css会进行css解析，遇到js会进行js解析；浏览器在解析html时会开启一个预解析的线程，用于提前加载html之外的css、js等资源；在解析过程中遇到link标签，若资源未下载完成，则会继续解析剩下的html，因此css的解析不会阻塞html解析；而解析过程中遇到js文件，则会中止html解析，优先解析js并执行，因为js执行可能会更新DOM树，因此js解析会阻塞html解析。
- 解析css，构成CSS规则树
- 合成渲染树：将html树与css树合并成一个渲染树
    - 通过遍历得到的DOM，剔除掉不需要显示的节点，结合对应的CSS信息，生成最终的带样式信息的DOM树，即为渲染树
- 布局计算：根据渲染树的结构，计算每个节点在页面中的位置、大小等，生成布局信息
    - 布局树与渲染树并不是一一对应的，譬如伪元素并不是真实的节点，因此只体现在布局树里；而不需要显示的节点（display:none）并不会参与布局，则在布局树里面并不包含等
- 分层：浏览器根据布局信息对整个布局进行分层
- 绘制：将所有图层交给合成线程进行最终的页面绘制

### 渲染流程中的注意事项
- CSSOM的生成会阻塞渲染
- DOM与CSSOM是并行构建，但script脚本会阻塞HTML的解析
- 提升首屏幕渲染的核心在于减少首屏页面加载的内容以及渲染内容的复杂度

### 浏览器回流、重绘
    - 回流：重新计算布局树信息，当进行了影响布局的操作从而引起重新计算布局信息时就会产生回流；
        - 当DOM的结构、元素的结构发生变化就会导致样式和渲染树的重新计算，进而触发重新布局，即产生回流
    - 重绘：根据分层信息重新计算绘制指令，当修改了可见样式时就会触发重绘；
        - 当元素的外观样式发生变化，但未引起布局的变化，只会进行分层指令的重新计算，即产生重绘
    - 产生回流和重绘的因素
        - 回流
            - 首次渲染
            - 浏览器尺寸变化
            - 元素内容变化
            - 元素字体变化
            - 可见DOM的新增、删除操作
            - css伪类触发
            - DOM的查询
        - 重绘
            - 字体、颜色
            - outline属性
            - 背景色等
    - 避免产生回流、重绘的方式
        - 尽量使用css动画替代js动画
        - 避免频繁的DOM操作，可以采取合并操作的方式
        - 通过创建片段对DOM进行操作
        - 将DOM脱离文档流再操作完成之后再插入文档，以避免多次触发
        - 通过requestAnimationFrame进行动画在重绘周期内执行，避免不必要的回流
        - 对于复杂操作可以将元素设置隐藏，操作完成之后再显示

### transform性能好的原因
transform处于布局和绘制之后，因此并不会产生回流和重绘


### 从输入URL到页面展示经历了什么？？？
